---
    sidebar_position: 1
    title: Common Database Queries
---

```sql title="queries.sql"
-- QUERY TO ADD RESOURCE, ADD RESOURCE_PRIVILAGE MAPPING AND ROLE_PRIVILAGE_RESOURCE_MAPPING
DECLARE @MODULE_CODE NVARCHAR(255) = 'wps';
DECLARE @PARENT_RESOURCE_CODE NVARCHAR(255) = 'Reports';
DECLARE @RESOURCE_NAME NVARCHAR(255) = N'Cheque/Online Report';
DECLARE @RESOURCE_DESCRIPTION NVARCHAR(255) = N'Cheque/Online Report';
DECLARE @ROUTE_URL NVARCHAR(255) = N'/modules/remittance/reports/cheque-online-report';
DECLARE @PRIVILEGE_NAME NVARCHAR(255) = N'view';
DECLARE @ROLE_NAME NVARCHAR(255) = N'SuperUser';


INSERT INTO CORE.COR_ACL_RESOURCE_NAME
(RESOURCE_NAME, PARENT_RESOURCE_CODE, RESOURCE_DESCRIPTION, CREATED_BY, CREATED_DATE, LAST_UPDATED_BY, LAST_UPDATED_DATE, RESOURCE_TYPE_LOOKUP_TENANT_CD, ROUTE_URL, ICON_NAME, MODULE_CODE, ACTIVE_FLAG, RESOURCE_TYPE_LKP_VALUE, RESOURCE_TYPE_LKP_TYPE, SORT_ORDER,  MODULE_ID)
VALUES(@RESOURCE_NAME,@PARENT_RESOURCE_CODE,@RESOURCE_DESCRIPTION, 'SYSTEM', GetDate(), 'SYSTEM', GetDate(), '1', @ROUTE_URL, 'fa-pencil-square-o',@MODULE_CODE, 1, 'MENU_ITEM', 'RESOURCE_TYPE',  '1',( SELECT id FROM CORE.COR_MODULE where MODULE_CODE = @MODULE_CODE));


INSERT INTO CORE.COR_ACL_RESOURCE_PRVLG_MAP
(CREATED_BY, CREATED_DATE, LAST_UPDATED_BY, LAST_UPDATED_DATE, PRIVILEGE_NAME, RESOURCE_NAME, ACTIVE_FLAG, PRIVILEGE_ID, RESOURCE_ID)
VALUES('SYSTEM', GetDate(), 'SYSTEM', GetDate(), @PRIVILEGE_NAME, @RESOURCE_NAME, 1, (SELECT id FROM CORE.COR_ACL_PRIVILEGE cap where PRIVILEGE_NAME =@PRIVILEGE_NAME), (SELECT id  FROM CORE.COR_ACL_RESOURCE_NAME cap where RESOURCE_NAME = @RESOURCE_NAME));


INSERT INTO CORE.COR_ACL_ROLE_PRVLG_RES_ASSOC
(CREATED_BY, CREATED_DATE, LAST_UPDATED_BY, LAST_UPDATED_DATE, PRIVILEGE_NAME, RESOURCE_NAME, ROLE_NAME, ACTIVE_FLAG, RESOURCE_ID, PRIVILEGE_ID, ROLE_ID)
VALUES ('SYSTEM', GetDate(), 'SYSTEM', GetDate(), @PRIVILEGE_NAME, @RESOURCE_NAME, @ROLE_NAME , 1, (SELECT id  FROM CORE.COR_ACL_RESOURCE_NAME cap where RESOURCE_NAME = @RESOURCE_NAME), (SELECT id FROM CORE.COR_ACL_PRIVILEGE cap where PRIVILEGE_NAME =@PRIVILEGE_NAME), (SELECT id from CORE.COR_ACL_ROLE WHERE ROLE_NAME =@ROLE_NAME));




-- Get ID details from core system
SELECT * FROM CO.ID_DETAILS WHERE ID_NUMBER = '784199227308279';


-- Get individual customer details using customer code
SELECT * FROM CO.CUSTOMER_INDIVIDUAL WHERE CUSTOMER_CODE = '280109';


-- Get core customer record using internal ID
SELECT * FROM CO.CUSTOMER WHERE ID = '280109';


-- Check if reverse transaction log exists for the reference
SELECT * FROM AFXINTEGRATIONS.REVERSE_TRANSACTIONS_LOG WHERE REFERENCE_NO = '25060407031392879';


-- Insert a reverse transaction record (initial state: X)
INSERT INTO AFXINTEGRATIONS.REVERSE_TRANSACTIONS_LOG
(TRANSACTION_NAME, REFERENCE_NO, STATE, RETRY_COUNT, ERROR_MESSAGE, MODULE, CREATED_DATE, LAST_UPDATED_DATE, CREATED_BY, LAST_UPDATED_BY)
VALUES(N'REVERSE_CARD_TRN', N'25060407031392879', N'X', 0, NULL, N'PPC', '2025-06-04 07:43:17.244', '2025-06-04 07:43:27.670', N'SAMEED.AHMAD', N'UPDATE TRN LOG');


-- Update transaction state to 'X' manually (e.g., to mark as failed or invalid)
UPDATE AFXINTEGRATIONS.REVERSE_TRANSACTIONS_LOG SET STATE = 'X' WHERE REFERENCE_NO = '25060407031392879';
```
