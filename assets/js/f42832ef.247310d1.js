"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4849],{8453:(E,e,R)=>{R.d(e,{R:()=>A,x:()=>_});var n=R(6540);const t={},r=n.createContext(t);function A(E){const e=n.useContext(r);return n.useMemo(function(){return"function"==typeof E?E(e):{...e,...E}},[e,E])}function _(E){let e;return e=E.disableParentContext?"function"==typeof E.components?E.components(t):E.components||t:A(E.components),n.createElement(r.Provider,{value:e},E.children)}},9198:(E,e,R)=>{R.r(e),R.d(e,{assets:()=>C,contentTitle:()=>_,default:()=>s,frontMatter:()=>A,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"testing-and-troubleshooting/common-db-queries","title":"Common Database Queries","description":"","source":"@site/docs/testing-and-troubleshooting/common-db-queries.mdx","sourceDirName":"testing-and-troubleshooting","slug":"/testing-and-troubleshooting/common-db-queries","permalink":"/afex-docs/docs/testing-and-troubleshooting/common-db-queries","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Common Database Queries"},"sidebar":"tutorialSidebar","previous":{"title":"Testing and Troubleshooting","permalink":"/afex-docs/docs/category/testing-and-troubleshooting"},"next":{"title":"Important Database Tables","permalink":"/afex-docs/docs/testing-and-troubleshooting/database-tables"}}');var t=R(4848),r=R(8453);const A={sidebar_position:1,title:"Common Database Queries"},_=void 0,C={},o=[];function O(E){const e={code:"code",pre:"pre",...(0,r.R)(),...E.components};return(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",metastring:'title="queries.sql"',children:"-- QUERY TO ADD RESOURCE, ADD RESOURCE_PRIVILAGE MAPPING AND ROLE_PRIVILAGE_RESOURCE_MAPPING\r\nDECLARE @MODULE_CODE NVARCHAR(255) = 'wps';\r\nDECLARE @PARENT_RESOURCE_CODE NVARCHAR(255) = 'Reports';\r\nDECLARE @RESOURCE_NAME NVARCHAR(255) = N'Cheque/Online Report';\r\nDECLARE @RESOURCE_DESCRIPTION NVARCHAR(255) = N'Cheque/Online Report';\r\nDECLARE @ROUTE_URL NVARCHAR(255) = N'/modules/remittance/reports/cheque-online-report';\r\nDECLARE @PRIVILEGE_NAME NVARCHAR(255) = N'view';\r\nDECLARE @ROLE_NAME NVARCHAR(255) = N'SuperUser';\r\n\r\n\r\nINSERT INTO CORE.COR_ACL_RESOURCE_NAME\r\n(RESOURCE_NAME, PARENT_RESOURCE_CODE, RESOURCE_DESCRIPTION, CREATED_BY, CREATED_DATE, LAST_UPDATED_BY, LAST_UPDATED_DATE, RESOURCE_TYPE_LOOKUP_TENANT_CD, ROUTE_URL, ICON_NAME, MODULE_CODE, ACTIVE_FLAG, RESOURCE_TYPE_LKP_VALUE, RESOURCE_TYPE_LKP_TYPE, SORT_ORDER,  MODULE_ID)\r\nVALUES(@RESOURCE_NAME,@PARENT_RESOURCE_CODE,@RESOURCE_DESCRIPTION, 'SYSTEM', GetDate(), 'SYSTEM', GetDate(), '1', @ROUTE_URL, 'fa-pencil-square-o',@MODULE_CODE, 1, 'MENU_ITEM', 'RESOURCE_TYPE',  '1',( SELECT id FROM CORE.COR_MODULE where MODULE_CODE = @MODULE_CODE));\r\n\r\n\r\nINSERT INTO CORE.COR_ACL_RESOURCE_PRVLG_MAP\r\n(CREATED_BY, CREATED_DATE, LAST_UPDATED_BY, LAST_UPDATED_DATE, PRIVILEGE_NAME, RESOURCE_NAME, ACTIVE_FLAG, PRIVILEGE_ID, RESOURCE_ID)\r\nVALUES('SYSTEM', GetDate(), 'SYSTEM', GetDate(), @PRIVILEGE_NAME, @RESOURCE_NAME, 1, (SELECT id FROM CORE.COR_ACL_PRIVILEGE cap where PRIVILEGE_NAME =@PRIVILEGE_NAME), (SELECT id  FROM CORE.COR_ACL_RESOURCE_NAME cap where RESOURCE_NAME = @RESOURCE_NAME));\r\n\r\n\r\nINSERT INTO CORE.COR_ACL_ROLE_PRVLG_RES_ASSOC\r\n(CREATED_BY, CREATED_DATE, LAST_UPDATED_BY, LAST_UPDATED_DATE, PRIVILEGE_NAME, RESOURCE_NAME, ROLE_NAME, ACTIVE_FLAG, RESOURCE_ID, PRIVILEGE_ID, ROLE_ID)\r\nVALUES ('SYSTEM', GetDate(), 'SYSTEM', GetDate(), @PRIVILEGE_NAME, @RESOURCE_NAME, @ROLE_NAME , 1, (SELECT id  FROM CORE.COR_ACL_RESOURCE_NAME cap where RESOURCE_NAME = @RESOURCE_NAME), (SELECT id FROM CORE.COR_ACL_PRIVILEGE cap where PRIVILEGE_NAME =@PRIVILEGE_NAME), (SELECT id from CORE.COR_ACL_ROLE WHERE ROLE_NAME =@ROLE_NAME));\r\n\r\n\r\n\r\n\r\n-- Get ID details from core system\r\nSELECT * FROM CO.ID_DETAILS WHERE ID_NUMBER = '784199227308279';\r\n\r\n\r\n-- Get individual customer details using customer code\r\nSELECT * FROM CO.CUSTOMER_INDIVIDUAL WHERE CUSTOMER_CODE = '280109';\r\n\r\n\r\n-- Get core customer record using internal ID\r\nSELECT * FROM CO.CUSTOMER WHERE ID = '280109';\r\n\r\n\r\n-- Check if reverse transaction log exists for the reference\r\nSELECT * FROM AFXINTEGRATIONS.REVERSE_TRANSACTIONS_LOG WHERE REFERENCE_NO = '25060407031392879';\r\n\r\n\r\n-- Insert a reverse transaction record (initial state: X)\r\nINSERT INTO AFXINTEGRATIONS.REVERSE_TRANSACTIONS_LOG\r\n(TRANSACTION_NAME, REFERENCE_NO, STATE, RETRY_COUNT, ERROR_MESSAGE, MODULE, CREATED_DATE, LAST_UPDATED_DATE, CREATED_BY, LAST_UPDATED_BY)\r\nVALUES(N'REVERSE_CARD_TRN', N'25060407031392879', N'X', 0, NULL, N'PPC', '2025-06-04 07:43:17.244', '2025-06-04 07:43:27.670', N'SAMEED.AHMAD', N'UPDATE TRN LOG');\r\n\r\n\r\n-- Update transaction state to 'X' manually (e.g., to mark as failed or invalid)\r\nUPDATE AFXINTEGRATIONS.REVERSE_TRANSACTIONS_LOG SET STATE = 'X' WHERE REFERENCE_NO = '25060407031392879';\n"})})}function s(E={}){const{wrapper:e}={...(0,r.R)(),...E.components};return e?(0,t.jsx)(e,{...E,children:(0,t.jsx)(O,{...E})}):O(E)}}}]);